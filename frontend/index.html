<!DOCTYPE html>
<html lang="pt">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Descubra os A√ßores - Plataforma de Turismo">
    <meta name="author" content="Group 2">
    <title>Azores Uncharted - Explore o Para√≠so</title>

    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&family=Playfair+Display:wght@400;500;600;700&display=swap" rel="stylesheet">

    <!-- Styles -->
    <link rel="stylesheet" href="css/styles.css">

    <!-- Map Library (Leaflet) -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css">
</head>
<body>
<!-- Header -->
<header>
    <nav>
        <div class="logo" onclick="showSection('home')">üèùÔ∏è Azores Uncharted</div>
        <ul class="nav-links">
            <li><a onclick="showSection('home')">In√≠cio</a></li>
            <li><a onclick="showSection('islands')">Ilhas</a></li>
            <li><a onclick="showSection('locations')">Locais</a></li>
            <li><a onclick="showSection('itineraries')">Itiner√°rios</a></li>
            <li><a onclick="showSection('favorites')">Favoritos</a></li>
            <li id="adminNavItem" class="nav-item hidden">
                <button class="nav-link" data-section="admin" onclick="openAdminPanel()">
                    <span class="nav-icon">‚öôÔ∏è</span>
                    <span>Painel Admin</span>
                </button>
            </li>
        </ul>
        <div class="auth-buttons" id="authButtons">
            <button class="btn btn-outline" onclick="openModal('login')">Entrar</button>
            <button class="btn btn-primary" onclick="openModal('register')">Registar</button>
        </div>
        <div class="user-menu hidden" id="userMenu">
            <div class="user-avatar" onclick="showSection('profile')">
                <span id="userInitial">U</span>
            </div>
        </div>
    </nav>
</header>

<!-- Hero Section -->
<section class="hero" id="heroSection">
    <div class="hero-content">
        <h1>Descubra os A√ßores</h1>
        <p>Explore as maravilhas naturais de nove ilhas √∫nicas</p>
        <div class="search-bar">
            <input
                    type="text"
                    id="searchInput"
                    placeholder="Pesquisar locais, ilhas, categorias..."
                    onkeyup="searchLocations()"
            >
            <button class="btn btn-primary" onclick="searchLocations()">Pesquisar</button>
        </div>
    </div>
</section>

<!-- Toast container -->
<div id="toastContainer" class="toast-container"></div>

<!-- Main Content -->
<div class="container">
    <!-- Home Section -->
    <section id="homeSection">
        <h2 class="section-title">Ilhas em Destaque</h2>
        <div class="islands-grid" id="islandsGrid"></div>

        <h2 class="section-title">Locais Populares</h2>
        <div class="locations-grid" id="popularLocations"></div>
    </section>

    <!-- Islands Section -->
    <section id="islandsSection" class="hidden">
        <h2 class="section-title">Todas as Ilhas</h2>
        <p class="section-subtitle">Selecione uma ilha para ver os melhores pontos tur√≠sticos.</p>
        <div class="islands-grid" id="allIslandsGrid"></div>
    </section>

    <!-- Locations Section -->
    <section id="locationsSection" class="hidden">
        <h2 class="section-title">Pontos Tur√≠sticos</h2>
        <div class="filters">
            <select class="filter-select" id="islandFilter" onchange="filterLocations()">
                <option value="">Todas as Ilhas</option>
            </select>
            <select class="filter-select" id="categoryFilter" onchange="filterLocations()">
                <option value="">Todas as Categorias</option>
                <option value="Miradouro">Miradouro</option>
                <option value="Lagoa">Lagoa</option>
                <option value="Termas">Termas</option>
                <option value="Cascata">Cascata</option>
                <option value="Praia">Praia</option>
                <option value="Cidade">Cidade</option>
            </select>
        </div>
        <div class="locations-grid" id="allLocations"></div>
    </section>

    <!-- Itineraries Section -->
    <section id="itinerariesSection" class="hidden">
        <h2 class="section-title">Itiner√°rios</h2>
        <p class="section-subtitle">Planeie viagens personalizadas com os seus pontos tur√≠sticos favoritos.</p>

        <div class="itinerary-layout">
            <!-- New Itinerary -->
            <div class="itinerary-card">
                <h3>Planear nova viagem</h3>
                <form id="itineraryForm" onsubmit="saveItinerary(event)">
                    <div class="form-group">
                        <label>Nome do itiner√°rio *</label>
                        <input type="text" id="itineraryName" required>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label>Data de in√≠cio</label>
                            <input type="date" id="itineraryStart">
                        </div>
                        <div class="form-group">
                            <label>Data de fim</label>
                            <input type="date" id="itineraryEnd">
                        </div>
                    </div>
                    <p class="muted">
                        Adicione pontos ao itiner√°rio atrav√©s do bot√£o
                        <strong>‚ÄúAdicionar ao itiner√°rio‚Äù</strong> em cada local.
                    </p>
                    <div id="currentItineraryPoints" class="itinerary-points-list"></div>
                    <div class="itinerary-actions">
                        <button type="button" class="btn btn-outline" onclick="clearCurrentItinerary()">
                            Limpar
                        </button>
                        <button type="submit" class="btn btn-primary">
                            Guardar itiner√°rio
                        </button>
                    </div>
                </form>
            </div>

            <!-- Existing Itineraries -->
            <div class="itinerary-card">
                <h3>Os meus itiner√°rios</h3>
                <div id="itinerariesList" class="itineraries-list">
                    <!-- Renderizado via JS -->
                </div>
            </div>
        </div>
    </section>

    <!-- Admin Section -->
    <section id="adminSection" class="hidden">
        <div class="section-header admin-header">
            <div class="admin-header-title">
                <span class="admin-tag">√Årea reservada</span>
                <h2 class="section-title">Painel do Administrador</h2>
                <p class="section-subtitle">
                    Gerir conte√∫dos tur√≠sticos, utilizadores da plataforma e monitorizar as integra√ß√µes com os servi√ßos externos.
                </p>
            </div>
            <div class="admin-header-chip">
                <span class="badge badge-outline">Azores Uncharted ‚Ä¢ Gest√£o</span>
            </div>
        </div>

        <div class="admin-grid">
            <!-- Coluna esquerda: Conte√∫dos + Integra√ß√µes -->
            <div class="admin-column">
                <!-- Gerir Conte√∫dos -->
                <div class="admin-card">
                    <div class="admin-card-header">
                        <h3>Gerir Conte√∫dos</h3>
                        <p class="admin-card-subtitle">
                            UC-13, UC-14, UC-15, UC-16, UC-17 ‚Äî Criar, editar, listar e remover pontos tur√≠sticos.
                        </p>
                    </div>

                    <form id="adminLocationForm" class="admin-form" onsubmit="submitAdminLocation(event)">
                        <input type="hidden" id="adminLocationId">

                        <div class="form-row">
                            <div class="form-group">
                                <label>Nome do ponto tur√≠stico *</label>
                                <input type="text" id="adminLocationName" required placeholder="Ex.: Lagoa das Sete Cidades">
                            </div>
                            <div class="form-group">
                                <label>Ilha *</label>
                                <input type="text" id="adminLocationIsland" required placeholder="Ex.: S√£o Miguel">
                            </div>
                        </div>

                        <div class="form-row">
                            <div class="form-group">
                                <label>Categoria</label>
                                <input type="text" id="adminLocationCategory" placeholder="Ex.: Miradouro, Lagoa, Termas‚Ä¶">
                            </div>
                            <div class="form-group">
                                <label>Imagem (URL)</label>
                                <input type="url" id="adminLocationImage" placeholder="https://">
                            </div>
                        </div>

                        <div class="form-group">
                            <label>Descri√ß√£o</label>
                            <textarea id="adminLocationDescription" rows="2" placeholder="Breve descri√ß√£o do ponto tur√≠stico."></textarea>
                        </div>

                        <div class="admin-form-actions">
                            <button type="submit" class="btn btn-primary" id="adminLocationSaveBtn">
                                Criar ponto tur√≠stico
                            </button>
                            <button type="button"
                                    class="btn btn-outline hidden"
                                    id="adminLocationCancelEditBtn"
                                    onclick="cancelAdminLocationEdit()">
                                Cancelar edi√ß√£o
                            </button>
                        </div>
                    </form>

                    <div class="table-wrapper">
                        <table class="admin-table">
                            <thead>
                            <tr>
                                <th>ID</th>
                                <th>Nome</th>
                                <th>Ilha</th>
                                <th>Categoria</th>
                                <th>A√ß√µes</th>
                            </tr>
                            </thead>
                            <tbody id="adminLocationsTableBody">
                            <!-- preenchido via JS -->
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- Monitorizar Integra√ß√µes -->
                <div class="admin-card">
                    <div class="admin-card-header">
                        <h3>Monitorizar Integra√ß√µes</h3>
                        <p class="admin-card-subtitle">
                            UC-23 ‚Äî Estado das integra√ß√µes com Geoapify, Open-Meteo e base de dados.
                        </p>
                    </div>

                    <div id="adminIntegrationsBody" class="admin-integrations">
                        <!-- preenchido via JS -->
                        <p class="muted">Clique em ‚ÄúPainel Admin‚Äù para verificar o estado das integra√ß√µes.</p>
                    </div>
                </div>
            </div>

            <!-- Coluna direita: Utilizadores -->
            <div class="admin-column">
                <div class="admin-card">
                    <div class="admin-card-header">
                        <h3>Gerir Utilizadores</h3>
                        <p class="admin-card-subtitle">
                            UC-18, UC-19, UC-20, UC-21, UC-22 ‚Äî Criar, editar, listar e remover utilizadores.
                        </p>
                    </div>

                    <form id="adminUserForm" class="admin-form" onsubmit="submitAdminUser(event)">
                        <input type="hidden" id="adminUserId">

                        <div class="form-row">
                            <div class="form-group">
                                <label>Nome *</label>
                                <input type="text" id="adminUserName" required placeholder="Nome completo">
                            </div>
                            <div class="form-group">
                                <label>Email *</label>
                                <input type="email" id="adminUserEmail" required placeholder="utilizador@exemplo.com">
                            </div>
                        </div>

                        <div class="form-row">
                            <div class="form-group">
                                <label>Perfil / Role *</label>
                                <select id="adminUserRole" required>
                                    <option value="user">Utilizador</option>
                                    <option value="admin">Administrador</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label>Password <span id="adminUserPasswordLabelExtra">(apenas para novos utilizadores)</span></label>
                                <input type="password" id="adminUserPassword" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢">
                            </div>
                        </div>

                        <div class="admin-form-actions">
                            <button type="submit" class="btn btn-primary" id="adminUserSaveBtn">
                                Criar utilizador
                            </button>
                            <button type="button"
                                    class="btn btn-outline hidden"
                                    id="adminUserCancelEditBtn"
                                    onclick="cancelAdminUserEdit()">
                                Cancelar edi√ß√£o
                            </button>
                        </div>
                    </form>

                    <div class="table-wrapper">
                        <table class="admin-table">
                            <thead>
                            <tr>
                                <th>ID</th>
                                <th>Nome</th>
                                <th>Email</th>
                                <th>Role</th>
                                <th>Estado</th>
                                <th>A√ß√µes</th>
                            </tr>
                            </thead>
                            <tbody id="adminUsersTableBody">
                            <!-- preenchido via JS -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Favorites Section -->
    <section id="favoritesSection" class="hidden">
        <h2 class="section-title">Favoritos</h2>
        <p class="section-subtitle">
            Pontos tur√≠sticos que marcou como favoritos para acesso r√°pido.
        </p>
        <div class="locations-grid" id="favoriteLocations"></div>
    </section>

    <!-- Profile Section -->
    <section id="profileSection" class="hidden">
        <h2 class="section-title">Meu Perfil</h2>
        <div class="profile-card">
            <h3 id="profileName">Nome do Utilizador</h3>
            <p id="profileEmail">email@example.com</p>
            <p id="profilePreferences" class="muted">
                As suas prefer√™ncias ser√£o carregadas ap√≥s autentica√ß√£o.
            </p>
            <button class="btn btn-primary" style="margin-top: 1rem;" onclick="logout()">
                Terminar Sess√£o
            </button>
        </div>
    </section>
</div>

<!-- Login Modal -->
<div class="modal" id="loginModal">
    <div class="modal-content">
        <button class="modal-close" onclick="closeModal('login')">&times;</button>
        <h2 style="margin-bottom: 2rem;">Entrar</h2>
        <form onsubmit="login(event)">
            <div class="form-group">
                <label>Email</label>
                <input type="email" id="loginEmail" required>
            </div>
            <div class="form-group">
                <label>Password</label>
                <input type="password" id="loginPassword" required>
            </div>
            <button type="submit" class="btn btn-primary" style="width: 100%;">Entrar</button>
        </form>
    </div>
</div>

<!-- Register Modal -->
<div class="modal" id="registerModal">
    <div class="modal-content">
        <button class="modal-close" onclick="closeModal('register')">&times;</button>
        <h2 style="margin-bottom: 2rem;">Registar</h2>
        <form onsubmit="register(event)">
            <div class="form-group">
                <label>Nome</label>
                <input type="text" id="registerName" required>
            </div>
            <div class="form-group">
                <label>Email</label>
                <input type="email" id="registerEmail" required>
            </div>
            <div class="form-group">
                <label>Password</label>
                <input type="password" id="registerPassword" required>
            </div>
            <button type="submit" class="btn btn-primary" style="width: 100%;">Registar</button>
        </form>
    </div>
</div>

<!-- Location Details Modal -->
<div class="modal" id="locationModal">
    <div class="modal-content modal-lg">
        <button class="modal-close" onclick="closeLocationModal()">&times;</button>
        <div id="locationModalContent">
            <!-- Detalhes do local ser√£o injetados via JS -->
        </div>
    </div>
</div>

<!-- Footer with Wave Effect -->
<footer>
    <div class="footer-content">
        <div class="footer-section">
            <h3>Azores Uncharted</h3>
            <p>Descubra o para√≠so natural dos A√ßores atrav√©s das nove ilhas √∫nicas que comp√µem este arquip√©lago extraordin√°rio.</p>
        </div>
        <div class="footer-section">
            <h3>Links R√°pidos</h3>
            <ul>
                <li><a onclick="showSection('home')">In√≠cio</a></li>
                <li><a onclick="showSection('islands')">Ilhas</a></li>
                <li><a onclick="showSection('locations')">Locais</a></li>
                <li><a onclick="openModal('register')">Registar</a></li>
            </ul>
        </div>
        <div class="footer-section">
            <h3>Contacto</h3>
            <p>Email: info@azores_uncharted.pt</p>
            <p>Tel: +351 295 000 000</p>
            <p>Ponta Delgada, S√£o Miguel</p>
        </div>
    </div>
    <div class="footer-bottom">
        <p>&copy; 2025 Azores Uncharted. Todos os direitos reservados.</p>
    </div>
</footer>

<!-- External Libraries -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>

<!-- Scroll Quick Actions -->
<div class="scroll-quick-actions">
    <button
            class="scroll-btn scroll-btn-main"
            type="button"
            onclick="window.scrollTo({ top: 0, behavior: 'smooth' });"
            title="Voltar ao topo"
    >
        ‚Üë
    </button>

    <button
            class="scroll-btn"
            type="button"
            onclick="showSection('locations'); window.scrollTo({ top: 0, behavior: 'smooth' });"
            title="Ir para Locais"
    >
        üó∫
    </button>

    <button
            class="scroll-btn"
            type="button"
            onclick="showSection('favorites'); window.scrollTo({ top: 0, behavior: 'smooth' });"
            title="Ir para Favoritos"
    >
        ‚ù§
    </button>

    <button
            class="scroll-btn"
            type="button"
            onclick="showSection('itineraries'); window.scrollTo({ top: 0, behavior: 'smooth' });"
            title="Ir para Itiner√°rios"
    >
        ‚úà
    </button>
</div>

<!-- Scripts -->
<script type="module" src="js/main.js"></script>
</body>
</html>
